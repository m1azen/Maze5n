document.addEventListener("DOMContentLoaded", () => {
  const examForm = document.getElementById("examForm");

  // تأكد من أن العناصر موجودة قبل استخدامها
  if (examForm) {
    examForm.addEventListener("submit", async (event) => {
      event.preventDefault();

      const userId = document.getElementById("userId").value.trim();
      const examName = document.getElementById("examName").value.trim();
      const totalMarks = parseFloat(document.getElementById("totalMarks").value);
      const obtainedMarks = parseFloat(document.getElementById("obtainedMarks").value);

      const status = obtainedMarks >= totalMarks * 0.5 ? "ناجح" : "راسب";

      // إضافة النتيجة إلى Google Sheets
      await fetch(
        `https://sheets.googleapis.com/v4/spreadsheets/YOUR_SHEET_ID/values/Sheet3!A:E:append?valueInputOption=RAW&key=YOUR_API_KEY`,
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ values: [[userId, examName, totalMarks, obtainedMarks, status]] }),
        }
      );

      alert("تمت إضافة النتيجة بنجاح!");
    });
  } else {
    console.error("عنصر 'examForm' غير موجود!");
  }
});
